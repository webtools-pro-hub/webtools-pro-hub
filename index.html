<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free online tool to analyze keyword density and improve your content's SEO">
    <title>Optimize Your Content – Advanced Keyword Analyzer</title>
    <style>
        :root {
            --primary: #3498db;      /* WCAG-compliant light blue */
            --primary-dark: #2980b9;
            --secondary: #2ecc71;    /* WCAG-compliant soft green */
            --secondary-dark: #27ae60;
            --accent: #e74c3c;       /* For highlights */
            --background: #f8f9fa;   /* Light background */
            --text: #2c3e50;         /* Dark text (WCAG AAA contrast) */
            --text-light: #7f8c8d;
            --card-bg: #ffffff;      /* White cards */
            --border: #dfe6e9;
            --error: #e74c3c;
            --focus-ring: rgba(52, 152, 219, 0.5);
            --transition: 0.2s ease-in-out;
            --ad-bg: #f1f3f4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            background-color: var(--background);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Skip link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 8px;
            z-index: 100;
            transition: top var(--transition);
        }
        
        .skip-link:focus {
            top: 0;
        }
        
        /* Header styles */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: clamp(1.8rem, 4vw, 2.2rem);
            margin-bottom: 0.5rem;
        }
        
        .description {
            max-width: 600px;
            margin: 0 auto;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        /* Ad banner styles */
        .ad-banner {
            background-color: var(--ad-bg);
            padding: 1rem;
            text-align: center;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin: 1rem 0;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ad-banner.horizontal {
            width: 100%;
        }
        
        .ad-banner.vertical {
            width: 300px;
            height: 250px;
            margin: 0 auto;
        }
        
        .ad-placeholder {
            color: var(--text-light);
            font-style: italic;
        }
        
        /* Main content area */
        main {
            flex: 1;
            padding: 2rem 1rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }
        
        /* Input section */
        .input-section {
            margin-bottom: 2rem;
        }
        
        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
        }
        
        textarea {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            transition: border-color var(--transition), box-shadow var(--transition);
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--focus-ring);
        }
        
        /* Button styles */
        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all var(--transition);
            font-weight: 600;
            margin-top: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .btn:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--focus-ring);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        /* Results section */
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            transition: transform var(--transition), box-shadow var(--transition);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.3rem;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 0.5rem;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px dashed var(--border);
        }
        
        .stat-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .stat-name {
            font-weight: 600;
        }
        
        .stat-value {
            color: var(--secondary);
            font-weight: 600;
        }
        
        /* Loading indicator */
        .loading {
            display: none;
            text-align: center;
            margin: 1rem 0;
            color: var(--text-light);
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(52, 152, 219, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Error message */
        .error-message {
            color: var(--error);
            margin-top: 0.5rem;
            font-weight: 600;
            display: none;
        }
        
        .error-message.active {
            display: block;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 1.5rem;
            background-color: var(--text);
            color: white;
            margin-top: auto;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .results {
                grid-template-columns: 1fr;
            }
            
            textarea {
                min-height: 150px;
            }
        }
        
        @media (max-width: 480px) {
            header {
                padding: 1.5rem 1rem;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* Visually hidden utility class for screen readers */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Progress bar for real-time analysis */
        .progress-container {
            width: 100%;
            height: 4px;
            background-color: var(--border);
            margin-top: 0.5rem;
            border-radius: 2px;
            overflow: hidden;
            display: none;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--secondary);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- Skip to content link for screen readers -->
    <a href="#main-content" class="skip-link">Skip to content</a>
    
    <header role="banner">
        <div class="container">
            <h1>Optimize Your Content – Advanced Keyword Analyzer</h1>
            <p class="description" id="app-description">Paste your text below to analyze keyword density and improve your SEO in real-time</p>
        </div>
    </header>
    
    <!-- Top Ad Banner -->
    <div class="ad-banner horizontal" aria-label="Advertisement">
        <div class="ad-placeholder">Advertisement Space (728x90)</div>
    </div>
    
    <main id="main-content" role="main">
        <div class="content-wrapper">
            <div class="main-content">
                <section class="input-section" aria-labelledby="input-label">
                    <label for="text-input" class="input-label" id="input-label">Enter your text to analyze:</label>
                    <textarea 
                        id="text-input" 
                        aria-describedby="input-description"
                        placeholder="Paste your article, blog post, or any text content here..."
                        rows="8"
                    ></textarea>
                    <p id="input-description" class="visually-hidden">Text you enter will be analyzed for keyword density and SEO metrics</p>
                    
                    <div class="progress-container" id="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    
                    <div class="error-message" id="error-message" role="alert"></div>
                    
                    <button id="analyze-btn" class="btn" aria-label="Analyze text for keywords">
                        Analyze Text
                    </button>
                    
                    <div class="loading" id="loading-indicator">
                        <span class="spinner" aria-hidden="true"></span>
                        <span>Analyzing your content...</span>
                    </div>
                </section>
                
                <!-- Middle Ad Banner -->
                <div class="ad-banner horizontal" aria-label="Advertisement" style="margin-top: 2rem;">
                    <div class="ad-placeholder">Advertisement Space (728x90)</div>
                </div>
                
                <section class="results" id="results-container" aria-live="polite" aria-atomic="true" style="display: none;">
                    <article class="card" aria-labelledby="basic-stats-heading">
                        <h2 id="basic-stats-heading">Basic Statistics</h2>
                        <div class="stat-item">
                            <span class="stat-name">Total Words</span>
                            <span id="total-words" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">Unique Words</span>
                            <span id="unique-words" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">Keyword Density</span>
                            <span id="keyword-density" class="stat-value">0%</span>
                        </div>
                    </article>
                    
                    <article class="card" aria-labelledby="top-keywords-heading">
                        <h2 id="top-keywords-heading">Top Keywords</h2>
                        <div id="top-keywords">
                            <!-- Will be filled by JavaScript -->
                            <p class="empty-message">No keywords analyzed yet</p>
                        </div>
                    </article>
                    
                    <article class="card" aria-labelledby="word-analysis-heading">
                        <h2 id="word-analysis-heading">Word Analysis</h2>
                        <div class="stat-item">
                            <span class="stat-name">Longest Word</span>
                            <span id="longest-word" class="stat-value">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-name">Average Word Length</span>
                            <span id="avg-word-length" class="stat-value">0 letters</span>
                        </div>
                    </article>
                </section>
            </div>
        </div>
    </main>
    
    <footer role="contentinfo">
        <div class="container">
            <p>© <span id="current-year"></span> Keyword Density Analyzer</p>
        </div>
    </footer>

    <script>
        // Main application module
        const KeywordAnalyzer = (function() {
            // Configuration constants
            const DEBOUNCE_DELAY = 500; // milliseconds for input debouncing
            const PROGRESS_UPDATE_INTERVAL = 100; // milliseconds for progress bar updates
            const MIN_WORD_LENGTH = 2; // minimum word length to consider
            
            // DOM Elements
            const dom = {
                analyzeBtn: document.getElementById('analyze-btn'),
                textInput: document.getElementById('text-input'),
                resultsContainer: document.getElementById('results-container'),
                loadingIndicator: document.getElementById('loading-indicator'),
                errorMessage: document.getElementById('error-message'),
                progressContainer: document.getElementById('progress-container'),
                progressBar: document.getElementById('progress-bar'),
                currentYear: document.getElementById('current-year')
            };
            
            // State variables
            let state = {
                debounceTimer: null,
                progressInterval: null,
                lastAnalysisTime: 0
            };
            
            // Initialize the application
            function init() {
                setupEventListeners();
                setCurrentYear();
            }
            
            // Set up all event listeners
            function setupEventListeners() {
                // Button click handler
                dom.analyzeBtn.addEventListener('click', handleAnalysis);
                
                // Real-time input handler with debounce
                dom.textInput.addEventListener('input', function() {
                    clearTimeout(state.debounceTimer);
                    dom.progressContainer.style.display = 'block';
                    
                    // Update progress bar during typing
                    state.progressInterval = setInterval(() => {
                        const currentWidth = parseInt(dom.progressBar.style.width) || 0;
                        const newWidth = Math.min(currentWidth + 10, 90);
                        dom.progressBar.style.width = `${newWidth}%`;
                    }, PROGRESS_UPDATE_INTERVAL);
                    
                    state.debounceTimer = setTimeout(() => {
                        clearInterval(state.progressInterval);
                        dom.progressBar.style.width = '100%';
                        setTimeout(() => {
                            dom.progressContainer.style.display = 'none';
                            dom.progressBar.style.width = '0%';
                        }, 300);
                        handleAnalysis();
                    }, DEBOUNCE_DELAY);
                });
                
                // Handle Enter key in textarea
                dom.textInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && e.ctrlKey) {
                        handleAnalysis();
                    }
                });
            }
            
            // Set current year in footer
            function setCurrentYear() {
                dom.currentYear.textContent = new Date().getFullYear();
            }
            
            // Main analysis handler
            function handleAnalysis() {
                const text = dom.textInput.value.trim();
                
                // Clear previous results and errors
                hideResults();
                clearError();
                
                // Validate input
                if (!text) {
                    showError('Please enter some text to analyze');
                    return;
                }
                
                // Show loading indicator
                showLoading();
                
                // Use requestAnimationFrame to ensure UI updates before heavy processing
                requestAnimationFrame(() => {
                    try {
                        const startTime = performance.now();
                        const analysisResults = analyzeText(text);
                        const endTime = performance.now();
                        
                        // Only update if this is the most recent analysis
                        if (endTime > state.lastAnalysisTime) {
                            state.lastAnalysisTime = endTime;
                            displayResults(analysisResults);
                            
                            // Log performance (for debugging)
                            console.log(`Analysis completed in ${(endTime - startTime).toFixed(2)}ms`);
                        }
                    } catch (error) {
                        showError('An error occurred while analyzing your text');
                        console.error('Analysis error:', error);
                    } finally {
                        hideLoading();
                    }
                });
            }
            
            /**
             * Analyzes the given text and returns statistics
             * @param {string} text - The text to analyze
             * @returns {object} Analysis results
             */
            function analyzeText(text) {
                // Process the text into words (handles Unicode and special characters)
                const words = getWords(text);
                const wordCount = words.length;
                
                if (wordCount === 0) {
                    throw new Error('No valid words found in the text');
                }
                
                // Calculate word frequencies (case-insensitive)
                const wordFrequencies = calculateWordFrequencies(words);
                const uniqueWords = Object.keys(wordFrequencies).length;
                
                // Get top 5 keywords (excluding stop words if needed)
                const topKeywords = getTopKeywords(wordFrequencies, 5);
                
                // Calculate keyword density (percentage of top 5 words)
                const keywordDensity = calculateKeywordDensity(wordFrequencies, topKeywords);
                
                // Find longest word (handles Unicode characters correctly)
                const longestWord = findLongestWord(words);
                
                // Calculate average word length (Unicode-aware)
                const avgWordLength = calculateAverageWordLength(words);
                
                return {
                    totalWords: wordCount,
                    uniqueWords: uniqueWords,
                    topKeywords: topKeywords,
                    keywordDensity: keywordDensity,
                    longestWord: longestWord,
                    avgWordLength: avgWordLength
                };
            }
            
            /**
             * Extracts words from text, handling Unicode and special characters
             * @param {string} text - The input text
             * @returns {array} Array of words
             */
            function getWords(text) {
                // Unicode-aware word boundary matching
                // Matches letters from any language, numbers, and apostrophes within words
                const wordRegex = /[\p{L}\p{N}']+/gu;
                const words = text.toLowerCase().match(wordRegex) || [];
                
                // Filter out empty strings and very short words
                return words.filter(word => word.length > MIN_WORD_LENGTH);
            }
            
            /**
             * Calculates frequency of each word
             * @param {array} words - Array of words
             * @returns {object} Word frequency dictionary
             */
            function calculateWordFrequencies(words) {
                return words.reduce((frequencies, word) => {
                    frequencies[word] = (frequencies[word] || 0) + 1;
                    return frequencies;
                }, {});
            }
            
            /**
             * Gets top N keywords by frequency
             * @param {object} frequencies - Word frequency dictionary
             * @param {number} count - Number of top keywords to return
             * @returns {array} Sorted array of top keywords
             */
            function getTopKeywords(frequencies, count) {
                return Object.entries(frequencies)
                    .map(([word, count]) => ({ word, count }))
                    .sort((a, b) => b.count - a.count || a.word.localeCompare(b.word))
                    .slice(0, count);
            }
            
            /**
             * Calculates keyword density percentage
             * @param {object} frequencies - Word frequency dictionary
             * @param {array} topKeywords - Top keywords array
             * @returns {number} Density percentage
             */
            function calculateKeywordDensity(frequencies, topKeywords) {
                const totalWords = Object.values(frequencies).reduce((sum, count) => sum + count, 0);
                const topWordsCount = topKeywords.reduce((sum, item) => sum + item.count, 0);
                return (topWordsCount / totalWords * 100);
            }
            
            /**
             * Finds the longest word in the array (Unicode-aware)
             * @param {array} words - Array of words
             * @returns {string} Longest word found
             */
            function findLongestWord(words) {
                return words.reduce((longest, word) => 
                    [...word].length > [...longest].length ? word : longest, '');
            }
            
            /**
             * Calculates average word length (Unicode-aware)
             * @param {array} words - Array of words
             * @returns {number} Average length
             */
            function calculateAverageWordLength(words) {
                const totalLetters = words.reduce((sum, word) => sum + [...word].length, 0);
                return totalLetters / words.length;
            }
            
            /**
             * Displays analysis results in the UI
             * @param {object} data - Analysis results
             */
            function displayResults(data) {
                // Basic stats
                document.getElementById('total-words').textContent = data.totalWords.toLocaleString();
                document.getElementById('unique-words').textContent = data.uniqueWords.toLocaleString();
                document.getElementById('keyword-density').textContent = data.keywordDensity.toFixed(2) + '%';
                
                // Top keywords
                const topKeywordsContainer = document.getElementById('top-keywords');
                topKeywordsContainer.innerHTML = '';
                
                if (data.topKeywords.length === 0) {
                    topKeywordsContainer.innerHTML = '<p class="empty-message">No significant keywords found</p>';
                } else {
                    data.topKeywords.forEach(item => {
                        const percentage = ((item.count / data.totalWords) * 100).toFixed(2);
                        
                        const keywordElement = document.createElement('div');
                        keywordElement.className = 'stat-item';
                        keywordElement.innerHTML = `
                            <span class="stat-name">${escapeHtml(item.word)}</span>
                            <span class="stat-value">${item.count} (${percentage}%)</span>
                        `;
                        
                        topKeywordsContainer.appendChild(keywordElement);
                    });
                }
                
                // Word analysis
                document.getElementById('longest-word').textContent = 
                    data.longestWord ? escapeHtml(data.longestWord) : '-';
                document.getElementById('avg-word-length').textContent = 
                    data.avgWordLength.toFixed(2) + ' letters';
                
                // Show results
                showResults();
            }
            
            // UI Helper functions
            function showLoading() {
                dom.loadingIndicator.classList.add('active');
                dom.resultsContainer.setAttribute('aria-busy', 'true');
            }
            
            function hideLoading() {
                dom.loadingIndicator.classList.remove('active');
                dom.resultsContainer.setAttribute('aria-busy', 'false');
            }
            
            function showResults() {
                dom.resultsContainer.style.display = 'grid';
            }
            
            function hideResults() {
                dom.resultsContainer.style.display = 'none';
            }
            
            function showError(message) {
                dom.errorMessage.textContent = message;
                dom.errorMessage.classList.add('active');
                dom.errorMessage.focus();
            }
            
            function clearError() {
                dom.errorMessage.textContent = '';
                dom.errorMessage.classList.remove('active');
            }
            
            /**
             * Escapes HTML special characters to prevent XSS
             * @param {string} text - Text to escape
             * @returns {string} Escaped text
             */
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            // Public API
            return {
                init: init
            };
        })();
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', KeywordAnalyzer.init);
    </script>
</body>
</html>
